<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="A Valentine's Day scavenger hunt game for Patty">
  <title>Valentine's Day Game for Patty</title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;700&family=Pacifico&display=swap" rel="stylesheet">

  <style>
    :root {
      --white: #FFFFFF;
      --red: #FF4458;
      --lavender: #E6D5F5;
      --red-dark: #D63447;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Caveat', cursive;
      background: linear-gradient(135deg, var(--white) 0%, var(--lavender) 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .screen {
      display: none;
      width: 100%;
      max-width: 900px;
      margin: 0 auto;
    }

    .screen.active {
      display: block;
    }

    /* Landing Screen */
    #landing {
      text-align: center;
    }

    #landing h1 {
      font-family: 'Pacifico', cursive;
      color: var(--red);
      font-size: clamp(2rem, 5vw, 3.5rem);
      margin-bottom: 40px;
      line-height: 1.3;
    }

    #landing-svg {
      max-width: 400px;
      width: 100%;
      height: auto;
      margin: 0 auto 30px;
    }

    #landing p {
      font-size: clamp(1.5rem, 3vw, 2rem);
      margin-bottom: 30px;
      color: #333;
    }

    .btn {
      font-family: 'Caveat', cursive;
      font-size: clamp(1.5rem, 3vw, 2rem);
      font-weight: 700;
      background: var(--red);
      color: var(--white);
      border: none;
      padding: 15px 50px;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(255, 68, 88, 0.3);
    }

    .btn:hover {
      background: var(--red-dark);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 68, 88, 0.4);
    }

    .btn:active {
      transform: translateY(0);
    }

    /* Puzzle Screen */
    #puzzle {
      padding-bottom: 100px;
    }

    .puzzle-card {
      background: var(--white);
      border: 3px solid var(--lavender);
      border-radius: 20px;
      padding: 40px;
      margin: 0 auto;
      max-width: 700px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .riddle-text {
      font-size: clamp(1.5rem, 3vw, 2.2rem);
      text-align: center;
      margin-bottom: 30px;
      color: #333;
      line-height: 1.5;
    }

    .input-group {
      text-align: center;
    }

    #answer-input {
      font-family: 'Caveat', cursive;
      font-size: clamp(1.3rem, 2.5vw, 1.8rem);
      padding: 15px 20px;
      border: 2px solid var(--lavender);
      border-radius: 10px;
      width: 100%;
      max-width: 400px;
      margin-bottom: 20px;
      text-align: center;
      transition: border-color 0.3s ease;
    }

    #answer-input:focus {
      outline: none;
      border-color: var(--red);
    }

    .error-message {
      color: var(--red);
      font-size: clamp(1.2rem, 2vw, 1.5rem);
      margin-bottom: 15px;
      min-height: 30px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .error-message.show {
      opacity: 1;
      animation: shake 0.5s ease;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }

    /* Accumulated Answers Bar */
    .answers-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--white);
      border-top: 3px solid var(--lavender);
      padding: 15px 20px;
      display: flex;
      gap: 10px;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.1);
    }

    .answers-bar::-webkit-scrollbar {
      height: 8px;
    }

    .answers-bar::-webkit-scrollbar-track {
      background: var(--lavender);
    }

    .answers-bar::-webkit-scrollbar-thumb {
      background: var(--red);
      border-radius: 4px;
    }

    .answer-badge {
      background: var(--red);
      color: var(--white);
      padding: 8px 20px;
      border-radius: 20px;
      font-size: clamp(1rem, 2vw, 1.3rem);
      font-weight: 700;
      white-space: nowrap;
      scroll-snap-align: start;
      flex-shrink: 0;
    }

    /* Unscramble Screen */
    #unscramble {
      padding: 40px 20px;
      max-width: 1000px;
      margin: 0 auto;
    }

    .unscramble-instructions {
      font-size: clamp(1.8rem, 3vw, 2.5rem);
      text-align: center;
      margin-bottom: 40px;
      color: #333;
      opacity: 0;
      animation: fadeIn 0.8s ease forwards;
    }

    @keyframes fadeIn {
      to { opacity: 1; }
    }

    .word-bubbles-pool {
      display: flex;
      flex-wrap: nowrap;
      justify-content: center;
      gap: 15px;
      min-height: 150px;
      margin-bottom: 50px;
      padding: 20px;
    }

    /* Only wrap on smaller screens */
    @media (max-width: 900px) {
      .word-bubbles-pool {
        flex-wrap: wrap;
      }
    }

    .word-bubble {
      background: var(--red);
      color: var(--white);
      padding: 0.4em 1.2em;
      border-radius: 25px;
      font-size: clamp(1.2rem, 2.5vw, 1.8rem);
      font-weight: 700;
      cursor: grab;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(255, 68, 88, 0.3);
      user-select: none;
      position: relative;
      line-height: 1.2;
      height: fit-content;
      max-height: 50px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .word-bubble:active {
      cursor: grabbing;
    }

    .word-bubble.dragging {
      transform: scale(1.2);
      opacity: 0.8;
      z-index: 1000;
    }

    .word-bubble.locked {
      cursor: not-allowed;
      opacity: 0.6;
    }

    .word-bubble.correct {
      color: #00FF00;
    }

    .blanks-container {
      display: flex;
      flex-wrap: nowrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 30px;
      padding: 20px;
    }

    /* Only wrap on smaller screens */
    @media (max-width: 900px) {
      .blanks-container {
        flex-wrap: wrap;
      }
    }

    .blank {
      min-width: 80px;
      height: 50px;
      border: 3px dashed var(--lavender);
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      position: relative;
    }

    .blank.filled {
      border-style: solid;
      border-color: var(--red);
    }

    .blank.drag-over {
      background: rgba(255, 68, 88, 0.1);
      transform: scale(1.05);
    }

    /* Final Question Screen */
    .final-question-container {
      text-align: center;
      max-width: 700px;
      margin: 0 auto;
      padding-top: 60px;
      display: none;
    }

    .final-question-text {
      font-family: 'Pacifico', cursive;
      font-size: clamp(2rem, 4vw, 3rem);
      color: var(--red);
      margin-bottom: 60px;
      min-height: 80px;
    }

    .final-instruction {
      font-size: clamp(1.5rem, 3vw, 2rem);
      color: #333;
      margin-bottom: 30px;
      display: none;
    }

    #final-answer-input {
      font-family: 'Caveat', cursive;
      font-size: clamp(1.3rem, 2.5vw, 1.8rem);
      padding: 15px 20px;
      border: 2px solid var(--lavender);
      border-radius: 10px;
      width: 100%;
      max-width: 400px;
      margin-bottom: 20px;
      text-align: center;
      transition: border-color 0.3s ease;
    }

    #final-answer-input:focus {
      outline: none;
      border-color: var(--red);
    }

    #final-error-message {
      color: var(--red);
      font-size: clamp(1.2rem, 2vw, 1.5rem);
      margin-bottom: 15px;
      min-height: 30px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    #final-error-message.show {
      opacity: 1;
      animation: shake 0.5s ease;
    }

    /* Victory Screen */
    #victory {
      text-align: center;
      max-width: 600px;
      margin: 0 auto;
    }

    #victory-svg {
      width: 100%;
      max-width: 500px;
      height: auto;
      margin: 0 auto;
    }

    /* Victory Animations */
    @keyframes cuddle {
      0% { transform: translateX(0); }
      100% { transform: translateX(-5px); }
    }

    @keyframes sleep {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(-8deg); }
    }

    @keyframes angry-shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-3px); }
      50% { transform: translateX(3px); }
      75% { transform: translateX(-3px); }
    }

    @keyframes anger-pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.3); }
    }

    @keyframes heart-grow {
      0% {
        opacity: 0;
        transform: scale(0);
      }
      100% {
        opacity: 1;
        transform: scale(1);
      }
    }

    .stage-cuddle #woman {
      animation: cuddle 5s ease-in-out forwards;
    }

    .stage-sleep #man-head {
      animation: sleep 3s ease-out forwards;
      transform-origin: 265px 125px;
    }

    .stage-angry #woman {
      animation: angry-shake 0.3s ease-in-out infinite;
    }

    .stage-angry #anger-mark {
      animation: anger-pulse 0.6s ease-in-out infinite;
    }

    .stage-heart #heart,
    .stage-heart #signature {
      animation: heart-grow 1s ease-out forwards;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .word-bubbles-pool {
        min-height: 120px;
      }

      .blanks-container {
        gap: 8px;
      }

      .blank {
        min-width: 60px;
        height: 45px;
      }
    }
  </style>
</head>
<body>
  <!-- Landing Screen -->
  <div id="landing" class="screen active">
    <h1>A Valentine's Day game for Patty</h1>
    
    <svg id="landing-svg" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
      <!-- Floating hearts -->
      <circle cx="100" cy="80" r="15" fill="#FFB6C1" opacity="0.6"/>
      <circle cx="105" cy="75" r="15" fill="#FFB6C1" opacity="0.6"/>
      <path d="M 102.5 95 L 102.5 70" fill="#FFB6C1" opacity="0.6"/>

      <circle cx="300" cy="100" r="15" fill="#FFB6C1" opacity="0.6"/>
      <circle cx="305" cy="95" r="15" fill="#FFB6C1" opacity="0.6"/>
      <path d="M 302.5 115 L 302.5 90" fill="#FFB6C1" opacity="0.6"/>

      <circle cx="320" cy="180" r="12" fill="#FFB6C1" opacity="0.6"/>
      <circle cx="325" cy="176" r="12" fill="#FFB6C1" opacity="0.6"/>
      <path d="M 322.5 195 L 322.5 173" fill="#FFB6C1" opacity="0.6"/>

      <!-- Woman (left) -->
      <g id="woman-landing">
        <!-- Long hair strands - covering top of head, visible individual strands, tapering at bottom -->
        <!-- Left side hair -->
        <path d="M 176 95 Q 166 100 164 110 L 164 145 Q 163 165 161 180" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        <path d="M 178 94 Q 168 99 166 109 L 166 145 Q 165 165 163 180" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        <path d="M 180 93 Q 170 98 168 108 L 168 145 Q 167 165 165 180" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        <path d="M 182 92 Q 172 97 170 107 L 170 145 Q 169 165 167 180" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        <path d="M 184 91 Q 174 96 172 106 L 172 145 Q 171 165 169 180" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        
        <!-- Top coverage hair strands -->
        <path d="M 186 90 Q 180 88 176 92" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        <path d="M 186 90 Q 192 88 196 92" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        <path d="M 183 89 Q 186 87 189 89" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        
        <!-- Right side hair -->
        <path d="M 188 91 Q 198 96 200 106 L 200 145 Q 201 165 203 180" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        <path d="M 190 92 Q 200 97 202 107 L 202 145 Q 203 165 205 180" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        <path d="M 192 93 Q 202 98 204 108 L 204 145 Q 205 165 207 180" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        <path d="M 194 94 Q 204 99 206 109 L 206 145 Q 207 165 209 180" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        <path d="M 196 95 Q 206 100 208 110 L 208 145 Q 209 165 211 180" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        
        <!-- Head -->
        <circle cx="186" cy="110" r="20" fill="none" stroke="#000" stroke-width="3"/>
        <!-- Eyes -->
        <circle cx="180" cy="107" r="3" fill="#000"/>
        <circle cx="192" cy="107" r="3" fill="#000"/>
        <!-- Smile -->
        <path d="M 178 116 Q 186 122 194 116" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        <!-- Body -->
        <line x1="186" y1="130" x2="186" y2="180" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="186" y1="150" x2="166" y2="165" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="186" y1="150" x2="206" y2="165" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="186" y1="180" x2="170" y2="210" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="186" y1="180" x2="202" y2="210" stroke="#000" stroke-width="3" stroke-linecap="round"/>
      </g>

      <!-- Heart between them -->
      <circle cx="218" cy="150" r="8" fill="#FF4458"/>
      <circle cx="224" cy="150" r="8" fill="#FF4458"/>
      <path d="M 211 150 L 221 165 L 231 150" fill="#FF4458"/>

      <!-- Man (right) -->
      <g id="man-landing">
        <!-- Flatter, fuller spiky hair covering top better -->
        <!-- Top row - flatter spikes -->
        <line x1="245" y1="95" x2="243" y2="89" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="248" y1="94" x2="247" y2="88" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="250" y1="93" x2="250" y2="87" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="252" y1="94" x2="253" y2="88" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="255" y1="95" x2="257" y2="89" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        
        <!-- Fill in top coverage -->
        <line x1="242" y1="97" x2="240" y2="92" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="246" y1="96" x2="245" y2="91" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="254" y1="96" x2="255" y2="91" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="258" y1="97" x2="260" y2="92" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        
        <!-- Side spikes - fuller coverage -->
        <line x1="237" y1="100" x2="234" y2="96" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="239" y1="99" x2="236" y2="95" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="235" y1="102" x2="232" y2="99" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="233" y1="105" x2="230" y2="103" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        
        <line x1="263" y1="100" x2="266" y2="96" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="261" y1="99" x2="264" y2="95" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="265" y1="102" x2="268" y2="99" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="267" y1="105" x2="270" y2="103" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        
        <!-- Head -->
        <circle cx="250" cy="110" r="20" fill="none" stroke="#000" stroke-width="3"/>
        <!-- Eyes -->
        <circle cx="244" cy="107" r="3" fill="#000"/>
        <circle cx="256" cy="107" r="3" fill="#000"/>
        <!-- Smile -->
        <path d="M 242 116 Q 250 122 258 116" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        <!-- Body -->
        <line x1="250" y1="130" x2="250" y2="180" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="250" y1="150" x2="230" y2="165" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="250" y1="150" x2="270" y2="165" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="250" y1="180" x2="234" y2="210" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="250" y1="180" x2="266" y2="210" stroke="#000" stroke-width="3" stroke-linecap="round"/>
      </g>
    </svg>
    
    <p>Solve the puzzles to win!</p>
    <button id="start-btn" class="btn">Start</button>
  </div>

  <!-- Puzzle Screen -->
  <div id="puzzle" class="screen">
    <div class="puzzle-card">
      <p id="riddle-text" class="riddle-text"></p>
      <div class="input-group">
        <div id="error-message" class="error-message">Not quite! Try again</div>
        <input type="text" id="answer-input" placeholder="Your answer...">
        <br><br>
        <button id="submit-btn" class="btn">Submit</button>
      </div>
    </div>
    <div id="answers-bar" class="answers-bar"></div>
  </div>

  <!-- Unscramble Screen -->
  <div id="unscramble" class="screen">
    <div class="unscramble-instructions">Drag & drop to unscramble!</div>
    <div id="word-bubbles-pool" class="word-bubbles-pool"></div>
    <div id="blanks-container" class="blanks-container"></div>
    
    <div id="final-question-container" class="final-question-container">
      <div class="final-question-text" id="final-question-text"></div>
      <div class="input-group">
        <div id="final-error-message" class="error-message">Not quite! Try again</div>
        <input type="text" id="final-answer-input" placeholder="Your answer...">
        <br><br>
        <button id="final-submit-btn" class="btn">Submit</button>
      </div>
    </div>
  </div>

  <!-- Victory Screen -->
  <div id="victory" class="screen">
    <svg id="victory-svg" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
      <!-- Headboard -->
      <rect x="80" y="80" width="240" height="15" fill="#8B7355" stroke="#000" stroke-width="3" rx="5"/>
      
      <!-- Bed (3D perspective - can see top surface) -->
      <ellipse cx="200" cy="180" rx="130" ry="15" fill="#F5F5DC" stroke="#000" stroke-width="3"/>
      <rect x="70" y="165" width="260" height="40" fill="#F5F5DC" stroke="#000" stroke-width="3" rx="5"/>
      
      <!-- Pillows -->
      <ellipse cx="160" cy="115" rx="25" ry="12" fill="#FFFFFF" stroke="#000" stroke-width="2"/>
      <ellipse cx="240" cy="115" rx="25" ry="12" fill="#FFFFFF" stroke="#000" stroke-width="2"/>
      
      <!-- TV Stand -->
      <rect x="175" y="235" width="50" height="8" fill="#654321" stroke="#000" stroke-width="2"/>
      <rect x="180" y="220" width="40" height="15" fill="#654321" stroke="#000" stroke-width="2"/>
      
      <!-- Widescreen TV -->
      <rect x="140" y="200" width="120" height="70" fill="#1a1a1a" stroke="#000" stroke-width="3" rx="3"/>
      <rect x="145" y="205" width="110" height="60" fill="#2c5aa0" stroke="#000" stroke-width="2"/>
      <text x="200" y="240" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#E50914" text-anchor="middle">NETFLIX</text>

      <!-- Woman (left) -->
      <g id="woman">
        <!-- Long hair -->
        <path d="M 125 98 Q 115 96 112 106 L 112 135 L 112 155" stroke="#000" stroke-width="3" fill="none" stroke-linecap="round"/>
        <path d="M 127 97 Q 117 95 114 105 L 114 135 L 114 155" stroke="#000" stroke-width="3" fill="none" stroke-linecap="round"/>
        <path d="M 129 96 Q 119 94 116 104 L 116 135 L 116 155" stroke="#000" stroke-width="3" fill="none" stroke-linecap="round"/>
        <path d="M 131 97 Q 121 95 118 105 L 118 135 L 118 155" stroke="#000" stroke-width="3" fill="none" stroke-linecap="round"/>
        
        <path d="M 145 98 Q 155 96 158 106 L 158 135 L 158 155" stroke="#000" stroke-width="3" fill="none" stroke-linecap="round"/>
        <path d="M 143 97 Q 153 95 156 105 L 156 135 L 156 155" stroke="#000" stroke-width="3" fill="none" stroke-linecap="round"/>
        <path d="M 141 96 Q 151 94 154 104 L 154 135 L 154 155" stroke="#000" stroke-width="3" fill="none" stroke-linecap="round"/>
        <path d="M 139 97 Q 149 95 152 105 L 152 135 L 152 155" stroke="#000" stroke-width="3" fill="none" stroke-linecap="round"/>
        
        <!-- Head -->
        <circle cx="135" cy="112" r="15" fill="none" stroke="#000" stroke-width="3"/>
        <!-- Eyes -->
        <g id="woman-eyes">
          <circle cx="130" cy="110" r="2" fill="#000"/>
          <circle cx="140" cy="110" r="2" fill="#000"/>
        </g>
        <!-- Eyebrows (for angry stage) -->
        <g id="woman-eyebrows" opacity="0">
          <line x1="127" y1="105" x2="133" y2="107" stroke="#000" stroke-width="2" stroke-linecap="round"/>
          <line x1="137" y1="107" x2="143" y2="105" stroke="#000" stroke-width="2" stroke-linecap="round"/>
        </g>
        <!-- Mouth -->
        <g id="woman-mouth">
          <path d="M 130 117 Q 135 120 140 117" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        </g>
        <!-- Body -->
        <line x1="135" y1="127" x2="135" y2="165" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="135" y1="145" x2="155" y2="155" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="135" y1="145" x2="115" y2="155" stroke="#000" stroke-width="3" stroke-linecap="round"/>
      </g>

      <!-- Anger mark (appears during angry stage) -->
      <g id="anger-mark" opacity="0">
        <text x="165" y="110" font-size="24">ðŸ’¢</text>
      </g>

      <!-- Man (right) -->
      <g id="man">
        <!-- Body -->
        <line x1="235" y1="127" x2="235" y2="165" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="235" y1="145" x2="215" y2="155" stroke="#000" stroke-width="3" stroke-linecap="round"/>
        <line x1="235" y1="145" x2="255" y2="155" stroke="#000" stroke-width="3" stroke-linecap="round"/>

        <!-- Head group -->
        <g id="man-head" style="transform-origin: 235px 112px;">
          <!-- Shorter spiky hair -->
          <line x1="235" y1="97" x2="231" y2="90" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          <line x1="235" y1="97" x2="235" y2="89" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          <line x1="235" y1="97" x2="239" y2="90" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          <line x1="231" y1="99" x2="228" y2="93" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          <line x1="239" y1="99" x2="242" y2="93" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          <line x1="227" y1="101" x2="224" y2="96" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          <line x1="243" y1="101" x2="246" y2="96" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          <line x1="233" y1="98" x2="231" y2="92" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          <line x1="237" y1="98" x2="239" y2="92" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          <line x1="229" y1="100" x2="226" y2="95" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          <line x1="241" y1="100" x2="244" y2="95" stroke="#000" stroke-width="3" stroke-linecap="round"/>
          
          <!-- Head -->
          <circle cx="235" cy="112" r="15" fill="none" stroke="#000" stroke-width="3"/>
          <!-- Open eyes -->
          <g id="man-eyes">
            <circle cx="230" cy="110" r="2" fill="#000"/>
            <circle cx="240" cy="110" r="2" fill="#000"/>
          </g>
          <!-- Closed eyes -->
          <g id="man-eyes-closed" opacity="0">
            <line x1="227" y1="110" x2="233" y2="110" stroke="#000" stroke-width="2" stroke-linecap="round"/>
            <line x1="237" y1="110" x2="243" y2="110" stroke="#000" stroke-width="2" stroke-linecap="round"/>
          </g>
          <!-- Mouth -->
          <path d="M 230 117 Q 235 120 240 117" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>
        </g>
      </g>

      <!-- Heart (appears at end) -->
      <g id="heart" opacity="0">
        <path d="M 200 140 Q 190 110 160 110 Q 120 110 120 145 Q 120 175 200 220 Q 280 175 280 145 Q 280 110 240 110 Q 210 110 200 140 Z" fill="#FF4458" stroke="#FFF" stroke-width="4"/>
        <text id="signature" x="200" y="165" font-family="Pacifico, cursive" font-size="28" fill="#FFF" text-anchor="middle" opacity="0">love, Vince</text>
      </g>
    </svg>
  </div>

  <script>
    // Game state
    const state = {
      currentScreen: 'landing',
      currentPuzzle: 0,
      collectedAnswers: [],
      puzzles: [
        {
          riddle: "I don't play games, I run them. I'm the 5th generation in my family. Find me to start your quest.",
          answer: "Tie"
        },
        {
          riddle: "Susan's been slacking off. She just sits there doing nothing, spinning in her own thoughts.",
          answer: "U"
        },
        {
          riddle: "E orâ€¦",
          answer: "N"
        },
        {
          riddle: "The first step on the stairway to heaven (or the last step on the stairway to hell).",
          answer: "Eye"
        },
        {
          riddle: "A woman in white, she's standing on height. A man below, she seems to know. To say hello, he'll need to climb. But he won't and he can't, 'cause they're frozen in time.",
          answer: "N"
        },
        {
          riddle: "My favorite photo of you.",
          answer: "Bee"
        },
        {
          riddle: "Look through your contacts.",
          answer: "M"
        },
        {
          riddle: "Mirror mirror on a door, inside you'll find what you're looking for.",
          answer: "Will"
        },
        {
          riddle: "Your partner's initials (full legal name)",
          answer: "VAL"
        }
      ],
      correctOrder: ["Will", "U", "Bee", "M", "Eye", "VAL", "N", "Tie", "N"],
      unscrambleState: {
        placed: {},
        locked: new Set()
      }
    };

    // Drag and drop state
    let draggedElement = null;
    let draggedFrom = null;

    // Initialize game
    function initGame() {
      document.getElementById('start-btn').addEventListener('click', startGame);
      document.getElementById('submit-btn').addEventListener('click', submitAnswer);
      document.getElementById('answer-input').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          submitAnswer();
        }
      });
      document.getElementById('final-submit-btn').addEventListener('click', submitFinalAnswer);
      document.getElementById('final-answer-input').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          submitFinalAnswer();
        }
      });
    }

    // Show screen
    function showScreen(screenName) {
      document.querySelectorAll('.screen').forEach(screen => {
        screen.classList.remove('active');
      });
      document.getElementById(screenName).classList.add('active');
      state.currentScreen = screenName;
    }

    // Start game
    function startGame() {
      showScreen('puzzle');
      loadPuzzle(0);
    }

    // Load puzzle
    function loadPuzzle(puzzleIndex) {
      const puzzle = state.puzzles[puzzleIndex];
      document.getElementById('riddle-text').textContent = puzzle.riddle;
      document.getElementById('answer-input').value = '';
      document.getElementById('error-message').classList.remove('show');
      displayAccumulatedAnswers();
    }

    // Validate answer
    function validateAnswer(input, correctAnswer) {
      return input.trim().toLowerCase() === correctAnswer.toLowerCase();
    }

    // Submit answer
    function submitAnswer() {
      const input = document.getElementById('answer-input').value;
      const puzzle = state.puzzles[state.currentPuzzle];
      const errorMessage = document.getElementById('error-message');

      // Check for shortcut on question 1
      if (state.currentPuzzle === 0 && input.trim().toLowerCase() === 'krabbypatty') {
        // Skip to unscramble with all answers collected
        state.collectedAnswers = state.puzzles.map(p => p.answer);
        state.currentPuzzle = state.puzzles.length;
        showUnscrambleScreen();
        return;
      }

      if (validateAnswer(input, puzzle.answer)) {
        errorMessage.classList.remove('show');
        advancePuzzle();
      } else {
        errorMessage.classList.add('show');
        setTimeout(() => {
          errorMessage.classList.remove('show');
        }, 2000);
      }
    }

    // Advance to next puzzle
    function advancePuzzle() {
      const currentAnswer = state.puzzles[state.currentPuzzle].answer;
      state.collectedAnswers.push(currentAnswer);
      state.currentPuzzle++;

      if (state.currentPuzzle < state.puzzles.length) {
        loadPuzzle(state.currentPuzzle);
      } else {
        showUnscrambleScreen();
      }
    }

    // Display accumulated answers
    function displayAccumulatedAnswers() {
      const answersBar = document.getElementById('answers-bar');
      answersBar.innerHTML = '';

      state.collectedAnswers.forEach(answer => {
        const badge = document.createElement('div');
        badge.className = 'answer-badge';
        badge.textContent = answer;
        answersBar.appendChild(badge);
      });
    }

    // Show unscramble screen
    function showUnscrambleScreen() {
      showScreen('unscramble');
      
      // Animate badges from bottom bar to pool
      setTimeout(() => {
        const pool = document.getElementById('word-bubbles-pool');
        const blanksContainer = document.getElementById('blanks-container');
        
        // Create word bubbles in scattered positions
        state.collectedAnswers.forEach((answer, index) => {
          const bubble = document.createElement('div');
          bubble.className = 'word-bubble';
          bubble.textContent = answer;
          bubble.draggable = true;
          bubble.dataset.word = answer;
          bubble.dataset.bubbleId = `bubble-${index}`; // Unique ID for each bubble
          bubble.dataset.originalIndex = index;
          
          // Add random positioning
          bubble.style.animation = `fadeIn 0.5s ease ${index * 0.1}s forwards`;
          
          setupDragHandlers(bubble);
          pool.appendChild(bubble);
        });
        
        // Create blanks
        for (let i = 0; i < 9; i++) {
          const blank = document.createElement('div');
          blank.className = 'blank';
          blank.dataset.position = i;
          
          setupDropHandlers(blank);
          blanksContainer.appendChild(blank);
        }
      }, 300);
    }

    // Setup drag handlers for word bubbles
    function setupDragHandlers(bubble) {
      bubble.addEventListener('dragstart', (e) => {
        // Check if this specific bubble is locked, not just the word
        if (bubble.classList.contains('locked')) {
          e.preventDefault();
          return;
        }
        
        draggedElement = bubble;
        draggedFrom = bubble.parentElement.classList.contains('blank') ? bubble.parentElement : 'pool';
        bubble.classList.add('dragging');
        e.dataTransfer.effectAllowed = 'move';
      });

      bubble.addEventListener('dragend', (e) => {
        bubble.classList.remove('dragging');
      });
    }

    // Setup drop handlers for blanks
    function setupDropHandlers(blank) {
      blank.addEventListener('dragover', (e) => {
        e.preventDefault();
        blank.classList.add('drag-over');
      });

      blank.addEventListener('dragleave', (e) => {
        blank.classList.remove('drag-over');
      });

      blank.addEventListener('drop', (e) => {
        e.preventDefault();
        blank.classList.remove('drag-over');
        
        if (!draggedElement) return;
        
        const position = parseInt(blank.dataset.position);
        const word = draggedElement.dataset.word;
        const bubbleId = draggedElement.dataset.bubbleId;
        
        // If blank already has a word, swap or move back to pool
        const existingBubble = blank.querySelector('.word-bubble');
        if (existingBubble && existingBubble !== draggedElement) {
          // Move existing bubble back to pool or where dragged element came from
          if (draggedFrom === 'pool') {
            document.getElementById('word-bubbles-pool').appendChild(existingBubble);
          } else {
            draggedFrom.appendChild(existingBubble);
          }
          // Remove the existing bubble's placement record
          const existingBubbleId = existingBubble.dataset.bubbleId;
          delete state.unscrambleState.placed[blank.dataset.position];
        }
        
        // If dragging from another blank, clear that blank's state
        if (draggedFrom !== 'pool' && draggedFrom !== blank) {
          delete state.unscrambleState.placed[draggedFrom.dataset.position];
          draggedFrom.classList.remove('filled'); // Revert to dashed border
        }
        
        blank.appendChild(draggedElement);
        blank.classList.add('filled');
        state.unscrambleState.placed[position] = bubbleId;
        
        // Check if correct position
        if (state.correctOrder[position] === word) {
          draggedElement.classList.add('correct');
          draggedElement.classList.add('locked'); // Lock this specific bubble
        } else {
          draggedElement.classList.remove('correct');
          draggedElement.classList.remove('locked');
        }
        
        draggedElement = null;
        draggedFrom = null;
        
        checkUnscrambleComplete();
      });
    }

    // Setup drop handler for pool
    const pool = document.getElementById('word-bubbles-pool');
    pool.addEventListener('dragover', (e) => {
      e.preventDefault();
    });

    pool.addEventListener('drop', (e) => {
      e.preventDefault();
      
      if (!draggedElement) return;
      
      // Remove from blank if it was in one
      if (draggedFrom !== 'pool') {
        const bubbleId = draggedElement.dataset.bubbleId;
        delete state.unscrambleState.placed[draggedFrom.dataset.position];
        draggedFrom.classList.remove('filled'); // Revert to dashed border
      }
      
      pool.appendChild(draggedElement);
      draggedElement.classList.remove('correct');
      draggedElement.classList.remove('locked');
      
      draggedElement = null;
      draggedFrom = null;
    });

    // Check if unscramble is complete
    function checkUnscrambleComplete() {
      const blanks = document.querySelectorAll('.blank');
      let allFilled = true;
      let allCorrect = true;
      
      blanks.forEach((blank, index) => {
        const bubble = blank.querySelector('.word-bubble');
        if (!bubble) {
          allFilled = false;
        } else if (state.correctOrder[index] !== bubble.dataset.word) {
          allCorrect = false;
        }
      });
      
      if (allFilled && allCorrect) {
        // Immediately fade out instructions
        const instructions = document.querySelector('.unscramble-instructions');
        instructions.style.animation = 'none'; // Remove the fadeIn animation
        instructions.style.transition = 'opacity 0.5s ease';
        instructions.style.opacity = '0';
        
        // Completely remove from layout after fade
        setTimeout(() => {
          instructions.style.display = 'none';
        }, 500);
        
        setTimeout(() => {
          transformToQuestion();
        }, 500);
      }
    }

    // Transform unscrambled phrase to proper question
    function transformToQuestion() {
      const blanksContainer = document.getElementById('blanks-container');
      const pool = document.getElementById('word-bubbles-pool');
      const instructions = document.querySelector('.unscramble-instructions');
      
      // Collect all bubbles from blanks into a single phrase container
      const blanks = document.querySelectorAll('.blank');
      const phraseContainer = document.createElement('div');
      phraseContainer.style.cssText = `
        display: flex;
        gap: 10px;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        transition: all 1s ease;
        margin-bottom: 30px;
      `;
      
      // Move bubbles from blanks to phrase container
      blanks.forEach(blank => {
        const bubble = blank.querySelector('.word-bubble');
        if (bubble) {
          const clonedBubble = bubble.cloneNode(true);
          clonedBubble.draggable = false;
          phraseContainer.appendChild(clonedBubble);
        }
      });
      
      // Clear blanks and add phrase container
      blanksContainer.innerHTML = '';
      blanksContainer.appendChild(phraseContainer);
      
      // Float bubbles up immediately (instructions already faded out)
      setTimeout(() => {
        phraseContainer.style.transform = 'translateY(-200px)';
      }, 300);
      
      // After floating, fade out bubbles and fade in correct text
      setTimeout(() => {
        phraseContainer.style.transition = 'opacity 2s ease';
        phraseContainer.style.opacity = '0';
        
        // Start fading in the correct text while bubbles fade out
        setTimeout(() => {
          // Position the question container at the top where bubbles floated to
          const questionContainer = document.getElementById('final-question-container');
          const questionText = document.getElementById('final-question-text');
          const inputGroup = questionContainer.querySelector('.input-group');
          
          // Hide input group initially
          inputGroup.style.opacity = '0';
          inputGroup.style.transition = 'opacity 1s ease';
          
          // Position the container to match where bubbles ended (top of screen)
          questionContainer.style.cssText = `
            text-align: center;
            max-width: 700px;
            margin: -180px auto 0;
            display: block;
            position: relative;
          `;
          
          questionText.textContent = 'Will you be my valentine?';
          questionText.style.opacity = '0';
          questionText.style.transition = 'opacity 2s ease';
          questionText.style.marginBottom = '40px';
          
          // Fade in the text
          setTimeout(() => {
            questionText.style.opacity = '1';
            
            // Show input group after text is fully visible
            setTimeout(() => {
              inputGroup.style.opacity = '1';
            }, 2000); // Wait for text to fully fade in
          }, 50);
          
          // Remove phrase container after fade completes
          setTimeout(() => {
            blanksContainer.innerHTML = '';
          }, 2000);
        }, 100);
      }, 1300);
    }

    // Submit final answer
    function submitFinalAnswer() {
      const input = document.getElementById('final-answer-input').value;
      const errorMessage = document.getElementById('final-error-message');

      if (validateAnswer(input, 'yes')) {
        errorMessage.classList.remove('show');
        showVictory();
      } else {
        errorMessage.classList.add('show');
        setTimeout(() => {
          errorMessage.classList.remove('show');
        }, 2000);
      }
    }

    // Show victory screen
    function showVictory() {
      showScreen('victory');
      playVictoryAnimation();
    }

    // Play victory animation
    function playVictoryAnimation() {
      const svg = document.getElementById('victory-svg');

      // Stage 1: Cuddling (0-5s)
      svg.classList.add('stage-cuddle');

      // Stage 2: Man falls asleep (5-8s)
      setTimeout(() => {
        svg.classList.remove('stage-cuddle');
        svg.classList.add('stage-sleep');

        // Close man's eyes
        document.getElementById('man-eyes').style.opacity = '0';
        document.getElementById('man-eyes-closed').style.opacity = '1';
      }, 5000);

      // Stage 3: Woman gets mad (8-12s)
      setTimeout(() => {
        svg.classList.remove('stage-sleep');
        svg.classList.add('stage-angry');

        // Show anger mark and angry eyebrows
        document.getElementById('anger-mark').style.opacity = '1';
        document.getElementById('woman-eyebrows').style.opacity = '1';

        // Change mouth to frown
        document.getElementById('woman-mouth').innerHTML = '<path d="M 130 120 Q 135 117 140 120" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>';
      }, 8000);

      // Stage 4: Woman smiles lovingly (12-15s)
      setTimeout(() => {
        svg.classList.remove('stage-angry');

        // Remove anger mark and angry eyebrows
        document.getElementById('anger-mark').style.opacity = '0';
        document.getElementById('woman-eyebrows').style.opacity = '0';

        // Change to loving smile
        document.getElementById('woman-mouth').innerHTML = '<path d="M 130 117 Q 135 122 140 117" stroke="#000" stroke-width="2" fill="none" stroke-linecap="round"/>';
      }, 12000);

      // Stage 5: Heart appears (15-18s)
      setTimeout(() => {
        svg.classList.add('stage-heart');
      }, 15000);
    }

    // Start the game on page load
    initGame();
  </script>
</body>
</html>